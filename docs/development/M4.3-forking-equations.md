# M4.3 Forking Equation Witness Integration

**Status:** In progress  
**Owner:** Formal verification team  
**Last updated:** 2025-11-18

## Overview

We introduced a reusable interface for supplying verifier-equation certificates to the forking extractor:

- `formal/LambdaSNARK/ForkingEquations.lean` defines the typeclass `ForkingEquationWitness` together with promotion helpers to obtain `ProtocolForkingEquations` and `ForkingEquationsProvider` values.
- `formal/LambdaSNARK/Soundness.lean` now consumes a `ForkingEquationsProvider` directly. The helper theorem `knowledge_soundness_of` bridges any circuit equipped with a witness instance.
- `formal/tests/HealthcareForkingEquations.lean` instantiates the witness for the healthcare circuit and exposes `healthcare_knowledge_soundness` as a concrete specialisation.

Lean rebuild (`lake build`) is clean after these changes.

## Pending Work

1. **Replace axioms with proofs**
   - `healthcare_quotient_eval`: prove interpolation equality using the concrete witness polynomial and the primitive 10th root `healthcareOmega`.
   - `healthcare_remainder_zero`: prove vanishing of the remainder modulo `vanishing_poly` via divisibility of the evaluation domain polynomial.
2. **Generalise tooling**
   - Port the witness interface to additional circuits (e.g., plaquette) once the healthcare case is fully mechanised.
3. **Testing & documentation**
   - Provide example uses of `knowledge_soundness_of` in higher-level scenarios and link this document from the main architectural overview.

## Next Steps

- Formal verification team to schedule proof work for the two outstanding axioms (target: sprint M4.4).
- Update `docs/architecture.md` after the axioms are eliminated to capture the complete forking pipeline.
